<ion-content>
  <ion-grid class="container" [class.blur]="profileService.popup" [class.darkContainer]="theme.darkMode">

    <!-- Header -->
    <div class="header">
      <ion-img *ngIf="!hiveService.profileImage" class="profile-img" src="/assets/images/default-contact.svg"></ion-img>
      <ion-avatar *ngIf="hiveService.profileImage">
        <ion-img src="hiveService.profileImage"></ion-img>
      </ion-avatar>
      <h1 mode='md' *ngIf="profile">
        {{ profile.getName() }}
      </h1>
      <ion-row *ngIf="!theme.darkMode" class="btn-row">
        <ion-img src="/assets/buttons/scan.svg" (click)="showQRCode()"></ion-img>
        <ion-img src="/assets/buttons/edit.svg" (click)="showOptions($event, 'edit')"></ion-img>
        <ion-img src="/assets/buttons/options.svg" (click)="showOptions($event, 'profile')"></ion-img>
      </ion-row>
      <ion-row *ngIf="theme.darkMode" class="btn-row">
        <ion-img src="/assets/buttons/darkmode/scan.svg" (click)="showQRCode()"></ion-img>
        <ion-img src="/assets/buttons/darkmode/edit.svg" (click)="showOptions($event, 'edit')"></ion-img>
        <ion-img src="/assets/buttons/darkmode/options.svg" (click)="showOptions($event, 'profile')"></ion-img>
      </ion-row>
    </div>

    <!-- List Tabs -->
    <ion-segment>
      <ion-segment-button [class.active]="detailsActive" (click)="changeList('details')">
        <ion-label>Details</ion-label>
      </ion-segment-button>
      <ion-segment-button [class.active]="credsActive" (click)="changeList('credentials')">
        <ion-label>Credentials</ion-label>
      </ion-segment-button>
      <ion-segment-button [class.active]="capsulesActive" (click)="changeList('capsules')">
        <ion-label>Capsules</ion-label>
      </ion-segment-button>
    </ion-segment>

    <!-- Details List -->
    <ion-list *ngIf="detailsActive">

      <ion-row class="visibility-row">
        <ion-col offset="9.5" size="2.5" class="visibility-col">
          <p *ngIf="profileService.editingVisibility">Visiblity</p>
        </ion-col>
      </ion-row>

      <div *ngIf="profileService.visibleData.length > 0">
        <ion-row class="detail-row" *ngFor="let entry of profileService.visibleData">
          <ion-col size="9.5" class="detail-col">
            <h5>{{ entry.label }}</h5>
            <h4>{{ entry.value }} </h4>
          </ion-col>
          <ion-col *ngIf="profileService.editingVisibility" size="2.5" class="checkbox-col">
            <ion-checkbox
              [(ngModel)]="entry.willingToBePubliclyVisible"
              [disabled]="!profileService.editingVisibility"
              color="success"
              mode="ios"
              [ngClass]="{ 'checkBox-visibility-edit': profileService.editingVisibility }">
            </ion-checkbox>
          </ion-col>
        </ion-row>
      </div>
      <div *ngIf="profileService.invisibleData.length > 0">
        <ion-row class="detail-row" *ngFor="let entry of profileService.invisibleData">
          <ion-col size="9.5" class="detail-col">
            <h5>{{ entry.label }}</h5>
            <h4>{{ entry.value }} </h4>
          </ion-col>
          <ion-col *ngIf="profileService.editingVisibility" size="2.5" class="checkbox-col">
            <ion-checkbox
              [(ngModel)]="entry.willingToBePubliclyVisible"
              [disabled]="!profileService.editingVisibility"
              color="success"
              mode="ios"
              [ngClass]="{ 'checkBox-visibility-edit': profileService.editingVisibility }">
            </ion-checkbox>
          </ion-col>
        </ion-row>
      </div>

      <ion-row class="btn-container" [ngStyle]="{ 'visibility': (profileService.editingVisibility ? 'visible' : 'hidden') }">
        <ion-button color="success" (click)="publishVisibilityChanges()">
          <ion-label>{{ 'publish-changes' | translate }}</ion-label>
        </ion-button>
      </ion-row>

    </ion-list>

    <!-- Credentials List -->
    <ion-list *ngIf="credsActive && hasCredential">

      <ion-row>
        <ion-col offset="9.5" size="2.5" class="visibility-col">
          <p *ngIf="profileService.editingVisibility">Visiblity</p>
        </ion-col>
      </ion-row>

      <div *ngIf="profileService.visibleData.length > 0">
        <ion-row class="cred-row" *ngFor="let entry of profileService.visibleCred">
          <ion-col offset="0.25" size="9.25">
            <ion-card>
              <ion-row>
                <ion-col size="2">
                  <ion-avatar></ion-avatar>
                </ion-col>
                <ion-col size="10">
                  <ion-label class="title" >{{ getDisplayableCredentialTitle(entry) }}</ion-label>
                </ion-col>
              </ion-row>
              <div class="property">
                <ion-row  *ngFor="let prop of displayableProperties(entry.credential)">
                  <ion-col class="value">
                    <div>{{ prop.value }}</div>
                  </ion-col>
                </ion-row>
              </div>
            </ion-card>
          </ion-col>
          <ion-col *ngIf="profileService.editingVisibility" size="2.5" class="checkbox-col">
            <ion-checkbox
              [(ngModel)]="entry.willingToBePubliclyVisible"
              [disabled]="!profileService.editingVisibility"
              color="success"
              mode="ios"
              [ngClass]="{ 'checkBox-visibility-edit': profileService.editingVisibility }">
            </ion-checkbox>
          </ion-col>
        </ion-row>
      </div>

      <div *ngIf="profileService.invisibleData.length > 0">
        <ion-row class="cred-row" *ngFor="let entry of profileService.invisibleCred">
          <ion-col offset="0.25" size="9.25">
            <ion-card>
              <ion-row>
                <ion-col size="2">
                  <ion-avatar></ion-avatar>
                </ion-col>
                <ion-col size="10">
                  <ion-label class="title" >{{ getDisplayableCredentialTitle(entry) }}</ion-label>
                </ion-col>
              </ion-row>
              <div class="property">
                <ion-row  *ngFor="let prop of displayableProperties(entry.credential)">
                  <ion-col class="value">
                    <!-- TODO here: Display prop.key in case the credential contains several keys and those keys are different from the credential key -->
                    <div>{{ getDisplayableEntryValue(prop.value) }}</div>
                  </ion-col>
                </ion-row>
              </div>
            </ion-card>
          </ion-col>
          <ion-col *ngIf="profileService.editingVisibility" size="2.5" class="checkbox-col">
            <ion-checkbox
              [(ngModel)]="entry.willingToBePubliclyVisible"
              [disabled]="!profileService.editingVisibility"
              color="success"
              mode="ios"
              [ngClass]="{ 'checkBox-visibility-edit': profileService.editingVisibility }">
            </ion-checkbox>
          </ion-col>
        </ion-row>
      </div>

      <ion-row class="btn-container" [ngStyle]="{ 'visibility': (profileService.editingVisibility ? 'visible' : 'hidden') }">
        <ion-button color="success" (click)="publishVisibilityChanges()">
          <ion-label>{{ 'publish-changes' | translate }}</ion-label>
        </ion-button>
      </ion-row>

    </ion-list>

    <ion-list *ngIf="capsulesActive" class="ion-text-center">
      <h1>No Capsules</h1>
      <p>
        You can find capsules by exploring the ecosystem - contacts, social networks,
        websites and start building up your favorites. You will then be able to decide
        what Capsules you share with others here.
      </p>
    </ion-list>

  </ion-grid>
</ion-content>


<!--
<div class="root-container">

  <ion-content no-bounce>
    <ion-grid class="ion-no-padding">
      <div class="profile-container">
        <div class="profile-picture">
          <img [src]="profile.getDefaultProfilePicturePath()">
        </div>
        <div class="profile-items">
          <ion-grid>
            <ion-row>
              <ion-col>
                <div class="name" *ngIf="profile">{{profile.getName()}}</div>
              </ion-col>
            </ion-row>

            <ion-row>
              <ion-col>
                <div class="actions">
                  <rounded-action-button title="publish" *ngIf="didNeedsToBePublished" image="assets/images/Publish_Simple_Icon.svg" (click)="publishDIDDocument()" color="var(--action-color)" imgcolor="#FFFFFF"></rounded-action-button>
                  <rounded-action-button title="share" image="assets/images/Share_Icon.svg" (click)="shareIdentity()" color="var(--action-color)" imgcolor="#FFFFFF"></rounded-action-button>
                  <rounded-action-button title="qr-code" image="assets/images/QR_Simple_Icon.svg" (click)="showQRCode()" color="var(--action-color)" imgcolor="#FFFFFF"></rounded-action-button>
                  <rounded-action-button title="edit-profile" image='assets/images/Edit_Simple_Icon.svg' (click)="editProfile()" color="var(--action-color)" imgcolor="#FFFFFF"></rounded-action-button>
                  <rounded-action-button title="edit-visibility" image="assets/images/Visibility_Tick_Simple_Icon.svg" (click)="editVisibility()" color="var(--action-color)" imgcolor="#FFFFFF"></rounded-action-button>

                  <rounded-action-button title="password" image="assets/images/Password_Simple_Icon.svg" (click)="changePassword()" color="var(--action-color)" imgcolor="#FFFFFF"></rounded-action-button>
                  <rounded-action-button title="delete-did" image="assets/images/Delete_Warning_Simple_Icon.svg" (click)="deleteDID()" color="#FF4D4D" imgcolor="#FFFFFF"></rounded-action-button>
                </div>
              </ion-col>
            </ion-row>

            <ion-row *ngIf="visibleData.length > 0">
              <ion-col class="ion-no-padding">
                <div class="section">
                  <div class="section-title">{{'my-visible-data'|translate}}</div>
                  <ion-list>
                    <ion-item *ngFor="let entry of visibleData" class="ion-no-margin">
                      <ion-label class="cred-name" >{{entry.label}}</ion-label>
                      <ion-label class="cred-value ion-text-right">{{entry.value}}</ion-label>
                      <ion-checkbox [(ngModel)]="entry.willingToBePubliclyVisible" [disabled]="!editingVisibility" mode="ios" [ngClass]="{'checkBox-visibility-edit': editingVisibility}"></ion-checkbox>
                    </ion-item>
                  </ion-list>
                </div>
              </ion-col>
            </ion-row>

            <ion-row *ngIf="invisibleData.length > 0">
              <ion-col class="ion-no-padding">
                <div class="section">
                  <div class="section-title">{{'my-hidden-data'|translate}}</div>
                  <ion-list>
                    <ion-item *ngFor="let entry of invisibleData" class="ion-no-margin">
                      <ion-label class="cred-name" >{{entry.label}}</ion-label>
                      <ion-label class="cred-value ion-text-right">{{entry.value}}</ion-label>
                      <ion-checkbox [(ngModel)]="entry.willingToBePubliclyVisible" [disabled]="!editingVisibility" mode="ios" [ngClass]="{'checkBox-visibility-edit': editingVisibility}"></ion-checkbox>
                    </ion-item>
                  </ion-list>
                </div>
              </ion-col>
            </ion-row>

            <ion-row [ngStyle]="{'visibility':(editingVisibility?'visible':'hidden')}">
              <ion-col class="ion-text-center">
                  <did-button class="publish-button" (click)="publishVisibilityChanges()"
                    [title]="'publish-changes' | translate"
                    [textcolor]="'#FFFFFF'"
                    [bgcolor]="'var(--ion-color-primary)'"
                    [bordercolor]="'var(--ion-color-primary)'"
                    [shadow]="true"></did-button>
              </ion-col>
            </ion-row>
          </ion-grid>
        </div>
      </div>
    </ion-grid>
  </ion-content>
</div>
 -->



 <!--
    <ion-list *ngIf="!detailsActive && friendsApps.length > 0 && !fetchingApps" class="ion-no-padding">
      <ion-item
        class="app"
        *ngFor="let appInfo of friendsApps"
        color="light"
        mode="md"
        lines="none"
        details="none"
      >
        <ion-grid class="ion-no-padding" >
          <ion-row class="ion-align-items-center">
            <ion-col class="img-col" offset="0.5" size="2.5">
              <ion-avatar>
                <ion-img [src]="appInfo.app ? getAppIcon(appInfo.app.id) : '/assets/icon/elalogo.svg'"></ion-img>
              </ion-avatar>
            </ion-col>
            <ion-col size="5" class="appInfo-col">
              <h4 *ngIf="appInfo.app">{{ appInfo.app.name }}</h4>
              <h4 *ngIf="!appInfo.app">{{ appInfo.packageId }}</h4>
              <p *ngIf="appInfo.action">{{ appInfo.action }}</p>
            </ion-col>
            <ion-col offset="0.5" size="3" class="btn-col">
              <ion-button *ngIf="!appInfo.isInstalled" color="tertiary" (click)="discoverApp(appInfo.packageId)">
                <ion-label>{{ 'discover' | translate }}</ion-label>
              </ion-button>
              <ion-button *ngIf="appInfo.isInstalled && appInfo.app" color="tertiary" (click)="connectApp(appInfo.packageId)">
                <ion-label>{{ 'connect' | translate }}</ion-label>
              </ion-button>
              <ion-button *ngIf="appInfo.isInstalled && !appInfo.app" color="tertiary" (click)="friendsService.startApp(appInfo.packageId)">
                <ion-label>{{ 'open' | translate }}</ion-label>
              </ion-button>
            </ion-col>
          </ion-row>
        </ion-grid>
      </ion-item>
    </ion-list>

    <ion-list *ngIf="!detailsActive && fetchingApps" class="ion-no-padding">
      <ion-item class="ion-padding" lines="none" color="light">
        <ion-grid>
          <ion-row class="ion-text-center">
            <ion-col>
              <ion-spinner name="bubbles" color="primary"></ion-spinner>
            </ion-col>
          </ion-row>
        </ion-grid>
      </ion-item>
    </ion-list>

    <ion-list *ngIf="!detailsActive && friendsApps.length === 0 && !fetchingApps" class="ion-no-padding">
      <ion-item class="app" lines="none" color="light">
        <ion-grid>
          <ion-row>
            <ion-col>
              <ion-label class="no-apps ion-text-center">
                {{ 'no-apps' | translate }}
              </ion-label>
            </ion-col>
          </ion-row>
        </ion-grid>
      </ion-item>
    </ion-list> -->
